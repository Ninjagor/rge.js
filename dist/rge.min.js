var ns=Object.defineProperty;var ie=(r,t)=>{for(var e in t)ns(r,e,{get:t[e],enumerable:!0})};function Je(r){let t=this.keyStates,e=o=>{let a=o.key;!t[a]&&r[a]&&r[a].press&&(t[a]=!0,r[a].press())},i=o=>{let a=o.key;t[a]=!1,r[a]&&r[a].release&&r[a].release()};for(let o in r)document.addEventListener("keydown",e),document.addEventListener("keyup",i),setInterval(()=>os(this,r,o),100)}function os(r,t,e){r.keyStates[e]&&t[e]&&t[e].hold&&t[e].hold()}function Ke(r){this.mouseClickHandlers.push(r)}function qe(r){let t,e;if(this.renderingOrigin=="topleft")t=r.clientX-this.canvas.getBoundingClientRect().left+this.camx,e=r.clientY-this.canvas.getBoundingClientRect().top-this.camy;else{let i=this.canvas.parentElement.getBoundingClientRect();t=r.clientX-i.left-i.width/2+this.camx,e=r.clientY-i.top-i.height/2-this.camy}for(let i of this.entities)i.hitTest&&i.hitTest(t,e)&&i.onClickHandler()}function Ze(r){if(this.renderingOrigin=="topleft")this.mouseX=r.clientX-this.canvas.getBoundingClientRect().left+this.camx,this.mouseY=r.clientY-this.canvas.getBoundingClientRect().top-this.camy;else{let t=this.canvas.parentElement.getBoundingClientRect();this.mouseX=r.clientX-t.left-t.width/2+this.camx,this.mouseY=r.clientY-t.top-t.height/2-this.camy}}function Ue(r,t,e,i){let o=r-e,a=t-i;return Math.sqrt(o*o+a*a)}function je(r,t){let e=t.x,i=t.y,o=r.x,a=r.y,c=r.width,d=r.height,y=t.radius*2,g=e,x=i;return e<o?g=o:e>o+c&&(g=o+c),i<a?x=a:i>a+d&&(x=a+d),this.findDistance(e,i,g,x)<=y/2}function Ne(r,t){if(r.isDestroyed||t.isDestroyed)return!1;let e=Math.max(0,Math.min(r.x+r.width,t.x+t.width)-Math.max(r.x,t.x)),i=Math.max(0,Math.min(r.y+r.height,t.y+t.height)-Math.max(r.y,t.y));return e>0&&i>0}function Qe(r,t,e){let i=e.vertices,o=!1,a=0;for(let c=0;c<i.length;c++){a=c+1,a===i.length&&(a=0);let d=i[c],y=i[a];(d.y+e.y>=t&&y.y+e.y<t||d.y+e.y<t&&y.y+e.y>=t)&&r<(y.x+e.x-(d.x+e.x))*(t-(d.y+e.y))/(y.y+e.y-(d.y+e.y))+(d.x+ +e.x)&&(o=!o)}return o}function et(r,t,e,i,o,a,c){let d=this.collidePointEllipse(r,t,o,a,c),y=this.collidePointEllipse(e,i,o,a,c);if(d||y)return!0;let g=r-e,x=t-i,$=Math.sqrt(g*g+x*x),k=((o-r)*(e-r)+(a-t)*(i-t))/Math.pow($,2),P=r+k*(e-r),F=t+k*(i-t);return this.collidePointLine(P,F,r,t,e,i)?(g=P-o,x=F-a,Math.sqrt(g*g+x*x)<=c/2):!1}function tt(r,t,e,i,o){return this.findDistance(r,t,e,i)<=o/2}function it(r,t,e,i,o,a,c){let d=this.findDistance(r,t,e,i),y=this.findDistance(r,t,o,a),g=this.findDistance(e,i,o,a);return c===void 0&&(c=.1),d+y>=g-c&&d+y<=g+c}function st(r,t,e){let i=r.x,o=r.y,a=r.radius*2,c=t.vertices;e===void 0&&(e=!0);let d=0;for(let y=0;y<c.length;y++){d=y+1,d===c.length&&(d=0);let g=c[y],x=c[d];if(this.collideLineEllipse(g.x+t.x,g.y+t.y,x.x+t.x,x.y+t.y,i,o,a))return!0}return!!(e===!0&&this.collidePointPoly(i,o,t))}function rt(r,t,e,i,o,a,c,d,y){let g,x=((c-o)*(t-a)-(d-a)*(r-o))/((d-a)*(e-r)-(c-o)*(i-t)),$=((e-r)*(t-a)-(i-t)*(r-o))/((d-a)*(e-r)-(c-o)*(i-t));var k,P;return x>=0&&x<=1&&$>=0&&$<=1?(y&&(k=r+x*(e-r),P=t+x*(i-t)),y?(g={x:k,y:P},g):!0):y?(g={x:!1,y:!1},g):!1}function nt(r,t,e,i,o,a,c,d,y){let g,x,$,k,P;return y?(g=this.collideLineLine(r,t,e,i,o,a,o,a+d,!0),x=this.collideLineLine(r,t,e,i,o+c,a,o+c,a+d,!0),$=this.collideLineLine(r,t,e,i,o,a,o+c,a,!0),k=this.collideLineLine(r,t,e,i,o,a+d,o+c,a+d,!0),P={left:g,right:x,top:$,bottom:k}):(g=this.collideLineLine(r,t,e,i,o,a,o,a+d),x=this.collideLineLine(r,t,e,i,o+c,a,o+c,a+d),$=this.collideLineLine(r,t,e,i,o,a,o+c,a),k=this.collideLineLine(r,t,e,i,o,a+d,o+c,a+d)),g||x||$||k?y?P:!0:!1}function ot(r,t,e){let i=t.vertices,o=r.x,a=r.y,c=r.width,d=r.height;e==null&&(e=!0);for(var y=0,g=0;g<i.length;g++){y=g+1,y===i.length&&(y=0);var x=i[g],$=i[y],k=this.collideLineRect(x.x+t.x,x.y+t.y,$.x+t.x,$.y+t.y,o,a,c,d);if(k)return!0;if(e===!0){var P=this.collidePointPoly(o,a,t);if(P)return!0}}return!1}function at(r,t){return Math.sqrt((r.x-t.x)**2+(r.y-t.y)**2)<=r.radius+t.radius}function lt(r,t,e,i,o){for(let a=0;a<o.length;a++){let c=o[a].x,d=o[a].y,y=o[(a+1)%o.length].x,g=o[(a+1)%o.length].y;if(as(r,t,e,i,c,d,y,g))return!0}return!1}function as(r,t,e,i,o,a,c,d){let y=ue(r,t,e,i,o,a),g=ue(r,t,e,i,c,d),x=ue(o,a,c,d,r,t),$=ue(o,a,c,d,e,i);return(y>0&&g<0||y<0&&g>0)&&(x>0&&$<0||x<0&&$>0)}function ue(r,t,e,i,o,a){return(e-r)*(a-t)-(i-t)*(o-r)}function ht(r,t){let e=r.vertices,i=t.vertices,o=!1;for(let a=0;a<e.length;a++)if(console.log("testing collision: ",e[a].x,e[a].y,t),this.collidePointPoly(e[a].x+r.x,e[a].y+r.y,t)){o=!0;break}for(let a=0;a<i.length;a++)if(this.collidePointPoly(i[a].x+t.x,i[a].y+t.y,r)){o=!0;break}return o}var I=class{constructor(t,e,i=0){this.x=t,this.y=e,this.zIndex=i,this.isDestroyed=!1,this.onClick=null,this.class=[],this.isCurrentlyBeingDebugged=!1,this.id=void 0}update(){throw new Error('Method "update" must be implemented by subclasses')}addClass(t){this.class.push(t)}removeClass(t){this.class.pop(t)}addId(t){this.id=t}removeId(t){this.id=null}modifyId(t){this.id=t}render(t){throw new Error('Method "render" must be implemented by subclasses')}collisionLogic(t){throw new Error("Method 'collisionLogic' must be implemented by subclasses.")}destroy(){this.isDestroyed=!0}onClickHandler(){this.onClick&&this.onClick()}};var Y=class extends I{constructor(t,e,i,o="red"){super(t,e),this.radius=i,this.fillColor=o,this.debug=!1}renderDebugBorder(t){let e="lime";t.strokeStyle=e,t.lineWidth=2,t.beginPath(),t.ellipse(this.x,this.y,this.radius,this.radius,0,0,2*Math.PI),t.stroke()}update(t,e,i=this.radius,o=this.fillColor){this.x=t,this.y=e,this.radius=i,this.fillColor=o}setTexture(t,e="stretched"){this.texture=t,this.fillMode=e,this.renderTexture=!0}debugMode(){this.debug=!0}render(t){this.texture?this.texture.complete?this.fillMode==="cover"?this.renderCover(t):this.renderStretched(t):this.renderLoadingBackground(t):(t.fillStyle=this.fillColor,t.beginPath(),t.ellipse(this.x,this.y,this.radius,this.radius,0,0,2*Math.PI),t.fill()),this.debug&&this.renderDebugBorder(t)}renderLoadingBackground(t){let e="gray";t.fillStyle=e,t.beginPath(),t.ellipse(this.x,this.y,this.radius,this.radius,0,0,2*Math.PI),t.fill()}renderStretched(t){t.save(),t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.clip(),t.drawImage(this.texture,this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius),t.restore()}renderCover(t){let e=this.texture.width/this.texture.height,i=this.radius,o=this.x-i,a=this.y-i;t.save(),t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.clip(),t.drawImage(this.texture,o,a,2*i*e,2*i),t.restore()}hitTest(t,e){return Math.sqrt((t-this.x)**2+(e-this.y)**2)<=this.radius}};var z=class extends I{constructor(t,e,i,o,a="blue",c={},d=!0){super(t,e),this.width=i;let{borderWidth:y=0,borderColor:g}=c;this.borderColor=g,this.borderWidth=y,this.height=o,this.fillColor=a,d?this.enableCentered():this.disableCentered(),this.debug=!1}debugMode(){this.debug=!0}renderDebugBorder(t){let e="#19bf19";t.strokeStyle=e,t.lineWidth=2,t.strokeRect(this.x,this.y,this.width,this.height)}renderBorder(t,e,i){if(this.borderWidth<1)return;let o=i;t.strokeStyle=o,t.lineWidth=e,t.strokeRect(this.x,this.y,this.width,this.height)}enableCentered(){this.centered=!0,this.x=this.x-this.width/2,this.y=this.y-this.height/2}disableCentered(){this.centered=!1,this.x=this.x,this.y=this.y}update(t,e,i=this.fillColor){this.centered?(this.x=t-this.width/2,this.y=e-this.height/2):(this.x=t,this.y=e),this.fillColor=i}setTexture(t,e="stretched"){this.texture=t,this.fillMode=e,this.renderTexture=!0}render(t){this.texture?this.texture.complete?this.fillMode==="cover"?this.renderCover(t):this.renderStretched(t):this.renderLoadingBackground(t):(t.fillStyle=this.fillColor,t.fillRect(this.x,this.y,this.width,this.height),this.renderBorder(t,this.borderWidth,this.borderColor)),this.debug&&this.renderDebugBorder(t)}renderLoadingBackground(t){let e="gray";t.fillStyle=e,t.fillRect(this.x,this.y,this.width,this.height)}renderStretched(t){t.drawImage(this.texture,this.x,this.y,this.width,this.height)}renderCover(t){let e=this.texture.width/this.texture.height,i=this.width,o=this.width/e,a=this.x,c=this.y+(this.height-o)/2;t.drawImage(this.texture,a,c,i,o)}hitTest(t,e){return t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height}};var D=class extends I{constructor(t,e,i,o=16,a="black",c="Arial"){super(t,e),this.text=i,this.fontSize=o,this.font=c,this.fillStyle=a}update(t,e,i=this.text,o=this.fontSize,a=this.font){this.x=t,this.y=e,this.text=i,this.fontSize=o,this.font=a}getWidth(t){return t.font=`${this.fontSize}px ${this.font}`,t.measureText(this.text).width}getHeight(t){t.font=`${this.fontSize}px ${this.font}`;let e=t.measureText(this.text);return e.actualBoundingBoxAscent+e.actualBoundingBoxDescent}render(t){t.font=`${this.fontSize}px ${this.font}`,t.fillStyle=this.fillStyle,t.fillText(this.text,this.x,this.y)}collisionLogic(t){return!1}};var q=class extends I{constructor(t,e,i,o="green",a={}){super(t,e);let{borderWidth:c=0,borderColor:d="black"}=a;this.vertices=i,this.fillColor=o,this.borderWidth=c,this.borderColor=d,this.debug=!1,this.imageRotation=0}debugMode(){this.debug=!0}update(t,e,i=this.vertices,o=this.fillColor){this.x=t,this.y=e,this.vertices=i,this.fillColor=o}getBoundingBox(){let t=this.vertices[0].x+this.x,e=this.vertices[0].x+this.x,i=this.vertices[0].y+this.y,o=this.vertices[0].y+this.y;for(let a=1;a<this.vertices.length;a++){let c=this.vertices[a].x+this.x,d=this.vertices[a].y+this.y;t=Math.min(t,c),e=Math.max(e,c),i=Math.min(i,d),o=Math.max(o,d)}return{x:t,y:i,width:e-t,height:o-i}}setTexture(t,e=0,i="stretched"){this.texture=t,this.fillMode=i,this.renderTexture=!0,this.imageRotation=e}render(t){if(this.renderTexture&&this.texture)this.fillMode==="cover"?this.renderCover(t):this.renderStretched(t);else{t.fillStyle=this.fillColor,t.beginPath(),t.moveTo(this.vertices[0].x+this.x,this.vertices[0].y+this.y);for(let e=1;e<this.vertices.length;e++)t.lineTo(this.vertices[e].x+this.x,this.vertices[e].y+this.y);this.renderBorder(t),t.closePath(),t.fill()}this.debug&&this.renderDebugBorder(t)}renderDebugBorder(t){let e="lime";t.strokeStyle=e,t.lineWidth=2,t.beginPath(),t.moveTo(this.vertices[0].x+this.x,this.vertices[0].y+this.y);for(let i=1;i<this.vertices.length;i++)t.lineTo(this.vertices[i].x+this.x,this.vertices[i].y+this.y);t.closePath(),t.stroke()}renderBorder(t){let e=this.borderColor;t.strokeStyle=e,t.lineWidth=this.borderWidth,t.beginPath(),t.moveTo(this.vertices[0].x+this.x,this.vertices[0].y+this.y);for(let i=1;i<this.vertices.length;i++)t.lineTo(this.vertices[i].x+this.x,this.vertices[i].y+this.y);t.closePath(),t.stroke()}renderStretched(t){this.renderCover(t)}renderCover(t){let e=this.getBoundingBox(),i=e.width,o=e.height;t.save(),t.translate(this.x,this.y),t.rotate(this.imageRotation*Math.PI/180),t.translate(-this.x,-this.y),t.beginPath(),t.moveTo(this.vertices[0].x+this.x,this.vertices[0].y+this.y);for(let a=1;a<this.vertices.length;a++)t.lineTo(this.vertices[a].x+this.x,this.vertices[a].y+this.y);t.closePath(),t.clip(),t.drawImage(this.texture,e.x,e.y,i,o),t.restore(),t.restore()}hitTest(t,e){let i=!1;for(let o=0,a=this.vertices.length-1;o<this.vertices.length;a=o++){let c=this.vertices[o].x+this.x,d=this.vertices[o].y+this.y,y=this.vertices[a].x+this.x,g=this.vertices[a].y+this.y;d>e!=g>e&&t<(y-c)*(e-d)/(g-d)+c&&(i=!i)}return i}collisionLogic(t){return!1}};var pe=class{constructor(t,e=!1){this.audio=new Audio(t),this.loop=e,this.volume=1,this.audio.volume=this.volume,e?(this.audio.loop=!0,this.audio.play()):this.audio.addEventListener("ended",()=>{this.stopSound()})}playSound(){this.loop||(this.stopSound(),this.audio.play())}stopSound(){this.audio.pause(),this.audio.currentTime=0}pauseSound(){this.audio.pause()}beginLoop(){try{this.audio.loop=!0,this.audio.play()}catch(t){console.log("error",t)}}setVolume(t){this.volume=Math.max(0,Math.min(1,t)),this.audio.volume=this.volume}};var X=class extends I{constructor(t,e,i=[],o){super(t,e),this.entities=i,this.offsets=[],o&&o instanceof S&&o.watch(()=>{this.entities.forEach((a,c)=>{let d=this.offsets[c].x,y=this.offsets[c].y;a.update(t+d,e+y)})},[()=>this.x,()=>this.y])}addEntity(t,e=0,i=0){this.entities.push(t),this.offsets.push({x:e,y:i}),this.update(this.x,this.y)}removeEntity(t){let e=this.entities.indexOf(t);e!==-1&&(this.entities.splice(e,1),this.offsets.splice(e,1))}update(t,e){this.x=t,this.y=e,this.entities.forEach((i,o)=>{let a=this.offsets[o].x,c=this.offsets[o].y;i.update(t+a,e+c)})}render(t){this.entities.forEach(e=>{e.render(t)})}};var ct={};ie(ct,{Button:()=>ge,Error:()=>T,HTMLBasedPopup:()=>me,HTMLButton:()=>ye,HTMLDiv:()=>ve,HTMLInput:()=>xe,UIRect:()=>Z});var Z=class extends z{constructor(t,e,i,o,a="blue",c=!0,d=0,y=0,g="blue"){super(t,e,i,o,a,c),this.borderRadius=d,this.borderColor=g,this.borderWidth=y}update(t,e,i=this.fillColor){this.centered?(this.x=t-this.width/2,this.y=e-this.height/2):(this.x=t,this.y=e),this.fillColor=i}render(t){this.texture?this.texture.complete?this.fillMode==="cover"?this.renderCover(t):this.renderStretched(t):this.renderLoadingBackground(t):this.borderRadius>0?this.renderRoundedRect(t,this.x,this.y,this.width,this.height,this.borderRadius,this.fillColor):(t.fillStyle=this.fillColor,t.fillRect(this.x,this.y,this.width,this.height)),this.borderWidth>=1&&this.renderBorder(t,this.borderRadius)}renderRoundedRect(t,e,i,o,a,c,d){t.save(),t.beginPath(),t.moveTo(e+c,i),t.arcTo(e+o,i,e+o,i+a,c),t.arcTo(e+o,i+a,e,i+a,c),t.arcTo(e,i+a,e,i,c),t.arcTo(e,i,e+o,i,c),t.closePath(),t.fillStyle=d,t.fill(),t.restore()}renderBorder(t,e=0){let i=this.borderColor;t.strokeStyle=i,t.lineWidth=this.borderWidth,e>0?(t.save(),t.beginPath(),t.moveTo(this.x+e,this.y),t.arcTo(this.x+this.width,this.y,this.x+this.width,this.y+this.height,e),t.arcTo(this.x+this.width,this.y+this.height,this.x,this.y+this.height,e),t.arcTo(this.x,this.y+this.height,this.x,this.y,e),t.arcTo(this.x,this.y,this.x+this.width,this.y,e),t.closePath(),t.stroke(),t.restore()):t.strokeRect(this.x,this.y,this.width,this.height)}};var ge=class extends I{constructor(t,e,i){super(t,e);let{EngineRef:o,buttonColor:a="red",borderRadius:c=0,borderWidth:d=0,borderColor:y="black",text:g,textSize:x=16,textColor:$="black",font:k="Arial",onClick:P}=i;this.EngineRef=o,this.checkWrongTypeError(),this.text=g,this.textSize=x,this.textColor=$,this.font=k,this.fillColor=a,this.br=c,this.bw=d,this.bc=y,this.onClick=P,this.groupWrapper=null,this.textRef=null,this.createEntities()}checkWrongTypeError(t=null){if(!(this.EngineRef instanceof S))this.alertWrongTypeError();else if(t!=null||t!=null)throw new Error(t)}alertWrongTypeError(){throw new Error(`EngineRef is not of type \`Engine\`. Expected type \`Engine\`. Recieved type \`${typeof this.EngineRef}\``)}createEntities(){try{let t=new X(this.x,this.y);this.EngineRef.entities.push(t);let e=new D(this.x,this.y,this.text,this.textSize,this.textColor,this.font);this.EngineRef.entities.push(e),e.zIndex=10;let i=e.getWidth(this.EngineRef.context),o=e.getHeight(this.EngineRef.context),a=new Z(this.x,this.y,i+i*.5,o+o*2,this.fillColor,!0,this.br,this.bw,this.bc);a.zIndex=0,this.EngineRef.entities.push(a),a.onClick=this.onClick,this.EngineRef.addMouseClickHandler(a),t.addEntity(e),t.addEntity(a),e.x=e.x-i/2,e.y=e.y+o/3+o/10,this.groupWrapper=t,this.textRef=e}catch(t){this.checkWrongTypeError(t)}}update(t,e){if(this.x=t,this.y=e,this.groupWrapper&&(this.groupWrapper.update(t,e),this.textRef)){let i=this.textRef.getWidth(this.EngineRef.context),o=this.textRef.getHeight(this.EngineRef.context);this.textRef.update(t-i/2,e+o/3+o/10)}}render(t){}};var me=class{constructor(t,e,i){this.contents=e,this.containerId=t;let{width:o="500px",height:a="300px",title:c="",startXOffset:d=0,startYOffset:y=0,customDestructor:g=()=>{}}=i||{};this.width=o,this.height=a,this.title=c,this.startXOffset=d,this.startYOffset=y,this.customDestructor=g,this.createPopup(),this.addDraggableZone(),this.popup.appendChild(this.contents)}createPopup(){this.popup=document.createElement("div"),this.popup.classList.add("popup"),document.getElementById(this.containerId).appendChild(this.popup),this.popup.style.border="1px solid #ccc",this.popup.style.backgroundColor="#fff",this.popup.style.position="absolute",this.popup.style.padding="10px",this.popup.style.top="50%",this.popup.style.left="50%",this.popup.style.fontFamily="sans-serif",this.popup.style.borderTopLeftRadius="10px",this.popup.style.borderTopRightRadius="10px",this.popup.style.borderBottomLeftRadius="10px",this.popup.style.borderBottomRightRadius="10px";let t=-50+this.startXOffset,e=-50+this.startYOffset;this.popup.style.transform=`translate(${t}%, ${e}%)`,this.popup.style.height=this.height,this.popup.style.width=this.width,this.popup.style.paddingTop="35px",this.popup.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)"}addDraggableZone(){let t=document.createElement("div");t.classList.add("draggable-zone"),t.style.height="25px",t.style.background="white",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.background="rgba(0, 0, 0, 0.01)",t.style.width="100%",t.style.borderTopLeftRadius="10px",t.style.borderTopRightRadius="10px",t.style.borderBottom="1px solid rgba(0, 0, 0, 0.1)";let e=document.createElement("p");e.textContent=this.title,e.style.position="absolute",e.style.left="10px",e.style.top="50%",e.style.fontSize="12px",e.style.marginTop="3px",e.style.opacity="40%",e.style.fontFamily="sans-serif",e.style.height="20px",e.style.borderRadius="1000px",e.style.transform="translateY(-50%)",t.appendChild(e);let i=document.createElement("button");i.style.position="absolute",i.style.right="5px",i.style.top="50%",i.style.width="20px",i.style.height="20px",i.style.borderRadius="1000px",i.style.transform="translateY(-50%)",i.style.border="none",i.style.display="flex",i.style.alignItems="center",i.style.background="rgba(0, 0, 0, 0.03)",i.style.justifyContent="center",i.innerHTML='<p style="font-size: 13px; display: flex; align-items: center; justify-content: center; opacity: 0.6; font-family: monospace;">x</p>',i.style.cursor="pointer",i.addEventListener("mouseenter",()=>{i.style.background="rgba(0, 0, 0, 0.1)"}),i.addEventListener("mouseleave",()=>{i.style.background="rgba(0, 0, 0, 0.03)"}),i.addEventListener("mousedown",()=>{i.style.background="rgba(0, 0, 0, 0.2)"}),i.addEventListener("mouseup",()=>{i.style.background="rgba(0, 0, 0, 0.1)"}),i.addEventListener("click",()=>{this.removePopup()}),t.appendChild(i),this.popup.appendChild(t);let o=!1,a,c;t.addEventListener("mousedown",d=>{o=!0,a=d.clientX-this.popup.offsetLeft,c=d.clientY-this.popup.offsetTop}),document.addEventListener("mousemove",d=>{o&&(this.popup.style.left=d.clientX-a+"px",this.popup.style.top=d.clientY-c+"px")}),document.addEventListener("mouseup",()=>{o=!1})}removePopup(){this.customDestructor(),this.popup.parentNode.removeChild(this.popup),this.popup=null}};var T=class{constructor(t="",e="",i="",o=""){this.errorHeader=t,this.errorDetails=e,this.affectedFunction=o,this.canvasId=i,this.renderError()}renderError(){let t=document.getElementById(this.canvasId).parentElement,e=document.createElement("div");e.style.width="`100%",e.style.zIndex="`100",e.style.backgroundColor="rgba(143, 4, 4, 0.9)",e.style.padding="20px 10px",e.style.position="absolute",e.style.top="50%",e.style.left="50%",e.style.transform="translate(-50%, -50%)",e.style.display="flex-col",e.style.overflowY="auto",e.innerHTML=`
            <p style="font-family: sans-serif; margin: 20px 100px; color: #edb7b7; font-weight: 200; font-size: 22px;">Error</p>
            <h1 style="font-family: sans-serif; margin: 20px 100px; color: #edb7b7; font-weight: 500;">${this.errorHeader}</h1>
            <p style="font-family: monospace; margin: 20px 100px; color: #edb7b7; font-weight: 500; font-size: 20px; opacity: 60%;">${this.errorDetails}</p>
            <p style="font-family: monospace; margin: 20px 100px; color: #edb7b7; font-weight: 500; font-size: 20px; opacity: 90%;">Instigating Function: ${this.affectedFunction}</p>
        `,t.innerHTML="",t.appendChild(e)}};var ye=class{constructor(t,e,i={}){let{canvasId:o="",text:a="",onClick:c=()=>{},style:d="",id:y=`btn-${JSON.stringify(Math.random()*100)}`}=i;this.x=t,this.y=e,this.canvasId=o,this.text=a,this.onClick=c,this.style=d,this.id=y,this.ref=null,this.render()}render(){let t=`<button onclick="${this.onClick}" style="position: absolute; left: ${this.x}px; top: ${this.y}px;" id="${this.id}">Hello</button>`,e=document.getElementById(this.canvasId).parentElement,i=document.createElement("button");i.textContent=this.text,i.onclick=this.onClick,i.style.left=`${this.x}px`,i.style.position="absolute",i.style.top=`${this.y}px`,i.id=this.id,this.style.split(";").filter(a=>a.trim()!=="").forEach(a=>{let[c,d]=a.split(":").map(y=>y.trim());c&&d&&(i.style[c]=d)}),this.ref=i,e.appendChild(i)}destroy(){this.ref&&(document.getElementById(this.canvasId).parentElement.removeChild(this.ref),this.ref=null)}};var xe=class{constructor(t,e,i={}){let{canvasId:o="",placeholder:a="",style:c="",id:d=`input-${JSON.stringify(Math.random()*1e4)}`}=i;this.x=t,this.y=e,this.canvasId=o,this.placeholder=a,this.style=c,this.id=d,this.ref=null,this.render()}render(){let t=document.getElementById(this.canvasId).parentElement,e=document.createElement("input");e.placeholder=this.placeholder,e.style.left=`${this.x}px`,e.style.position="absolute",e.style.top=`${this.y}px`,e.id=this.id,this.style.split(";").filter(o=>o.trim()!=="").forEach(o=>{let[a,c]=o.split(":").map(d=>d.trim());a&&c&&(e.style[a]=c)}),this.ref=e,t.appendChild(e)}destroy(){this.ref&&(document.getElementById(this.canvasId).parentElement.removeChild(this.ref),this.ref=null)}};var ve=class{constructor(t,e,i={}){let{canvasId:o="",style:a="",id:c=`div-${JSON.stringify(Math.random()*1e4)}`}=i;this.x=t,this.y=e,this.canvasId=o,this.style=a,this.id=c,this.ref=null,this.render()}render(){let t=document.getElementById(this.canvasId).parentElement,e=document.createElement("div");e.style.left=`${this.x}px`,e.style.position="absolute",e.style.top=`${this.y}px`,e.id=this.id,this.style.split(";").filter(o=>o.trim()!=="").forEach(o=>{let[a,c]=o.split(":").map(d=>d.trim());a&&c&&(e.style[a]=c)}),this.ref=e,t.appendChild(e)}destroy(){this.ref&&(document.getElementById(this.canvasId).parentElement.removeChild(this.ref),this.ref=null)}};var ft={};ie(ft,{PBRect:()=>be});var be=class extends I{constructor(t,e,i){super(t,e);let{EngineRef:o,width:a,height:c,rotation:d=0,fillColor:y="red",borderWidth:g=0,borderColor:x="black"}=i;if(!o||!(o instanceof S))throw new Error("EngineRef is required as instance of Engine.");if(!a||!c)throw new Error("`width` and `height` are mandatory fields.");this.width=a,this.height=c,this.rotation=d,this.fillColor=y,this.EngineRef=o,this.borderWidth=g,this.borderColor=x,this.polyrectRef=null,this.generatePoly()}generatePoly(){let t=this.calculateRotatedRectVertices(this.x,this.y,this.width,this.height,this.rotation),e=new q(this.x,this.y,t,this.fillColor,{borderWidth:this.borderWidth,borderColor:this.borderColor});this.polyrectRef=e,this.EngineRef.entities.push(e)}calculateRotatedRectVertices(t,e,i,o,a){t=1,e=1;let c=a*Math.PI/180,d=Math.cos(c),y=Math.sin(c),g=t-i/2,x=e-o/2,$=t+i/2,k=e-o/2,P=t+i/2,F=e+o/2,O=t-i/2,V=e+o/2,G=t+(g-t)*d-(x-e)*y,se=e+(g-t)*y+(x-e)*d,re=t+($-t)*d-(k-e)*y,ne=e+($-t)*y+(k-e)*d,oe=t+(P-t)*d-(F-e)*y,J=e+(P-t)*y+(F-e)*d,Pe=t+(O-t)*d-(V-e)*y,ae=e+(O-t)*y+(V-e)*d;return[{x:G,y:se},{x:re,y:ne},{x:oe,y:J},{x:Pe,y:ae}]}update(t,e,i){let{width:o=this.width,height:a=this.height,rotation:c=this.rotation,fillColor:d=this.fillColor}=i||{};if(this.polyrectRef){this.polyrectRef.update(t,e);let y=this.calculateRotatedRectVertices(this.polyrectRef.x,this.polyrectRef.y,o,a,c);this.polyrectRef.vertices=y,this.polyrectRef.fillColor=d}}};function dt(){if(this.entities.sort((r,t)=>r.zIndex-t.zIndex),this.customZSort(),this.renderingOrigin=="topleft")for(let r of this.entities)this.context.save(),this.context.translate(-this.camx,this.camy),r.render(this.context),this.context.restore();else for(let r of this.entities)this.context.save(),this.context.translate(this.canvas.width/2-this.camx,this.canvas.height/2+this.camy),r.render(this.context),this.context.restore()}async function ut(){this.isStopped=!1,this.canvasLoadingView(),this.preloadExecuted||await this.preload(),this.setupExecuted||this.setup(),this.updateAssetLoadingCount(),setTimeout(()=>{this.animationFrameId=requestAnimationFrame(r=>this.gameLoop(r))},Object.keys(this.preloadedImages).length*(this.textureLoadingTime/Object.keys(this.preloadedImages).length))}function pt(r={}){let{preload:t,setup:e,tick:i,centeredOrigin:o}=r;t&&this.setPreload(t),e&&this.setupFunction(e),i&&this.setTickFunction(i),o===!0&&this.setCenterOrigin()}async function gt(r){if(this.preloadExecuted)throw new Error("loadImage can only be used in preload()");try{let e=await(await fetch(r)).blob(),i=new Image;i.src=URL.createObjectURL(e);let o=r.substring(r.lastIndexOf("/")+1);return this.preloadedImages[o]=i,i}catch(t){return console.error("Error loading image:",t),null}}function mt(){this.clearCanvas();let r=new D(0,0,"Loading assets...",30,"black");r.update(0-r.getWidth(this.context)/2,0),this.context.save(),this.context.translate(this.canvas.width/2,this.canvas.height/2),r.render(this.context),this.context.restore()}function yt(){let r=0,t=setInterval(()=>{this.canvasLoadingView(),this.loadedAssetsCount+=1,r<Object.keys(this.preloadedImages).length||clearInterval(t),r++},this.textureLoadingTime/Object.keys(this.preloadedImages).length)}async function xt(r,t){if(this.preloadExecuted)throw new Error("loadFont can only be used in preload()");try{let e=await fetch(r);console.log(e);let i=await e.blob();console.log(i);let o=new FontFace(t,i);return await o.load(),document.fonts.add(o),this.preloadedFonts[t]=o,o}catch(e){return console.error("Error loading font:",e),null}}async function vt(r,t){if(this.preloadExecuted)throw new Error("loadFont can only be used in preload()");try{let o=(await(await fetch(r)).text()).match(/url\(([^)]+)\)/);if(!o||o.length<2)throw new Error("Font URL not found in CSS");let a=o[1].replace(/['"]/g,""),c=new FontFace(t,`url(${a})`);return await c.load(),document.fonts.add(c),this.preloadedFonts[t]=c,c}catch(e){return console.error("Error loading font:",e),null}}var bt={};ie(bt,{get:()=>ni,push:()=>ai,remove:()=>oi,update:()=>li});function ni(r){try{let t=localStorage.getItem(r);return JSON.parse(t)}catch(t){throw console.error(t),new Error(t)}}function oi(r){try{let t=localStorage.removeItem(r)}catch(t){throw console.error(t),new Error(t)}}function ai(r,t){try{return localStorage.setItem(r,JSON.stringify(t))}catch(e){throw console.error(e),new Error(e)}}function li(r,t){try{let e=localStorage.removeItem(r);return localStorage.setItem(r,JSON.stringify(t))}catch(e){throw console.error(e),new Error(e)}}var Ee=class{constructor(t){this.events=[],this.callbackRegistry=[],this.canvasId=t.canvasId}emit(t){this.events.push(t)}subscribe(t,e,i){if(!t||!e||!i)throw new T("invalid subcription to EventBus");try{this.callbackRegistry.push({subName:t,subEvent:e,callback:i}),console.log(this.callbackRegistry)}catch(o){throw console.error(o),new T("invalid subcription to EventBus")}}unsubscribe(t){let e=[];for(let i of this.callbackRegistry)i.subName!=t&&e.push(i);this.callbackRegistry=e}process(){for(let t of this.events)for(let e of this.callbackRegistry)if(e.subEvent==t)try{e.callback()}catch(i){new T("EventBus Callback Error",`The callback provided for subscribed event "${t}" has failed. <br><br> <br> Instigating Callback: <br><br> ${e.callback}. <br><br> ${i} <br><br><br> Fix this error or remove the instigating callback to remove this message. <br><br>`,this.canvasId,"subscribe()");let o=new T("Error: Callback for event in EventBus failed.");throw o.name="",o}this.events=[]}};var S=class{constructor(t,e=60,i={}){let{isEmbedded:o=!1,__fcm__:a=!1,maxEntities:c=500,webGLMode:d=!1}=i;this.isEmbedded=o,this.canvas=document.getElementById(t),this.isEmbedded&&this.canvas.setAttribute("data-entities",JSON.stringify([])),a||console.warn("Your code contains a raw Engine instantiation, which is not recommended for larger scale projects. Use SceneManager instead. To ignore, set __fcm__ to true in your Engine instantiation."),this.maxEntities=c,this.canvasId=t,d?this.context=this.canvas.getContext("webgl"):this.context=this.canvas.getContext("2d"),this.webGLMode=d,this.entities=[],this.tickFunction=()=>{},this.targetFps=e,this.targetFrameTime=1e3/e,this.lastTimestamp=0,this.deltaAccumulator=0,this.mouseX=0,this.mouseY=0,this.addKeyPressAction=Je.bind(this),this.addMouseClickHandler=Ke.bind(this),this.handleMouseClick=qe.bind(this),this.keyStates={},this.mouseClickHandlers=[],this.canvas.addEventListener("mousedown",this.handleMouseClick.bind(this)),this.collideRectRect=Ne.bind(this),this.collideRectEllipse=je.bind(this),this.collidePointPoly=Qe.bind(this),this.findDistance=Ue.bind(this),this.initMouseTracking=Ze.bind(this),this.canvas.addEventListener("mousemove",this.initMouseTracking.bind(this)),this.collideLineEllipse=et.bind(this),this.collidePointEllipse=tt.bind(this),this.collidePointLine=it.bind(this),this.collideEllipsePoly=st.bind(this),this.collideLineLine=rt.bind(this),this.collideLineRect=nt.bind(this),this.collideRectPoly=ot.bind(this),this.collideEllipseEllipse=at.bind(this),this.collideLinePoly=lt.bind(this),this.collidePolyPoly=ht.bind(this),this.animationFrameId=null,window.addEventListener("resize",this.handleResize),this.resizeCanvas(),this.renderingOrigin="topleft",this.customZSort=()=>{},this.canvas.addEventListener("mousedown",()=>{this.isMouseDown=!0}),this.canvas.addEventListener("mouseup",()=>{this.isMouseDown=!1}),this.backgroundColor=null,this.backgroundImage=null,this.backgroundRepeat=null,this.backgroundSize=null,this.preloadExecuted=!1,this.preload=async()=>{await this.customPreload(),this.preloadExecuted=!0},this.customPreload=async()=>{},this.preloadedImages={},this.preloadedFonts={},this.customPreloadFunction=null,this.setupExecuted=!1,this.customSetup=()=>{},this.loadedAssetsCount=0,this.textureLoadingTime=0,this.setup=()=>{this.customSetup(),this.setupExecuted=!0},this.renderEntities=dt.bind(this),this.start=ut.bind(this),this.configure=pt.bind(this),this.loadImage=gt.bind(this),this.loadFont=xt.bind(this),this.loadGoogleFont=vt.bind(this),this.canvasLoadingView=mt.bind(this),this.updateAssetLoadingCount=yt.bind(this),this.watchedVariables=[],this.debugWatchedEntities=[],this.debugWatchedEntitiesBackup=[],this.loggingDevMode=!1,this.localdata=bt,this.EventBus=Ee,this.isStopped=!1,this.camx=0,this.camy=0}print(t,e="log"){e=="error"?console.error(t):e=="warn"?console.warn(t):console.log(t)}setPreload(t){this.customPreload=t}arraysEqual(t,e){return t.length===e.length&&t.every((i,o)=>i===e[o])}watch(t,e){if(!Array.isArray(e)){new T("Dependency Array Error: Invalid Dependencies",`The dependencies which you provided: <br> <br> '${e}' <br> <br> is not an array of callback functions. Please follow the format: <br> <br> '[() => watchedVar]'`,this.canvasId,"watch()");let i=new T("Error: Dependencies must be an array of functions. For example: [() => watchedVar]");throw i.name="",i}this.watchedVariables.push({dependencies:e,callback:t,lastValues:e.map(i=>typeof i=="function"?i():i)})}checkWatchedVariables(){for(let t of this.watchedVariables){let{dependencies:e,callback:i}=t;if(!Array.isArray(e)){new T("Dependecy Array Error: Invalid Dependencies",`The dependencies which you provided: <br> <br> '${e}' <br> <br> is not an array of callback functions. Please follow the format: <br> <br> '[() => watchedVar]'`,this.canvasId,"watch()");let a=new T("Error: Dependencies must be an array of functions. For example: [() => watchedVar]");throw a.name="",a}let o=e.map(a=>typeof a=="function"?a():a);if(!Array.isArray(e)||e.some(a=>typeof a!="function")){new T("Dependecy Array Error: Invalid Dependencies",`The dependencies which you provided: <br> <br> '${JSON.stringify(e)}' <br> <br> is not an array of callback functions. Please follow the format: <br> <br> '[() => watchedVar]'`,this.canvasId,"watch()");let a=new T("Error: Dependencies must be an array of functions. For example: [() => watchedVar]");throw a.name="",a}this.arraysEqual(o,t.lastValues)||(i(),t.lastValues=o)}}enableDevMode(t=!1){if(console.warn("Dev mode is enabled. This may cause certain security features to be disabled, and may result in unexpected errors. In order to properly utilize devMode, make sure you call it at the TOP of your file (or right after you define `rge`)."),t)try{this.loggingDevMode=!0}catch(e){console.error(e)}this.textureLoadingTime=0}resizeCanvas(){this.canvas.width=this.canvas.parentElement.clientWidth,this.canvas.height=this.canvas.parentElement.clientHeight}getWidth(){return this.canvas.width*2}getHeight(){return this.canvas.height*2}debugEntity(t,e=10){let i=new D(t.x,t.y,t.id?t.id:"unnamed_entity",13,"green");this.addEntity(i),t.isCurrentlyBeingDebugged=!0,i.zIndex=100;let o=new Y(t.x,t.y,3,"black");this.addEntity(o);try{t.debugMode()}catch{console.warn("Entity does not implement a debug border. If this is a Text entity, Group Entity, or a custom entity, ignore.")}o.zIndex=100,this.debugWatchedEntities.push({text:i,entity:t,centerMarker:o,offsetY:e})}disableAllEntityDebugs(){this.debugWatchedEntitiesBackup=this.debugWatchedEntities,this.debugWatchedEntities=[]}reEnableAllEntityDebugs(){this.debugWatchedEntities=this.debugWatchedEntitiesBackup}handleResize=()=>{this.resizeCanvas()};stop(){this.isStopped=!0,this.entities=[],this.keyPressActions={},this.pressedKeys={},this.mouseClickHandlers=[],this.tickFunction=()=>{},cancelAnimationFrame(this.animationFrameId)}addEntity(t){if(this.entities.length+1>this.maxEntities){new T("Entity Overflow Error",`The current engine is currently holding <br><br> ${this.entities.length} <br><br> entities, which is the set limit. In order to increase the limit, please add <br><br>
            maxEntities: (desiredMax) <br><br> to the constructor of the engine OR, add <br><br>
            (engine).maxEntities = (desiredMax) <br><br> to your code. If you would like to remove this limit, please set maxEntities to Infinity.`,this.canvasId,"addEntity()");let e=new T("Entity Overflow Error: Entities array has reached its limit. Modify the engine maxEntities value.");throw e.name="",e}this.entities.push(t)}setTickFunction(t){this.tickFunction=t}setupFunction(t){this.customSetup=t}gameLoop(t){if(this.isStopped){this.clearCanvas();return}else if(this.preloadExecuted&&this.setupExecuted){if(this.lastTimestamp||(this.lastTimestamp=t),this.isEmbedded){let i=JSON.stringify(this.entities);this.canvas.setAttribute("data-entities",i)}let e=t-this.lastTimestamp;if(this.lastTimestamp=t,this.deltaAccumulator+=e,this.isStopped)return;for(;this.deltaAccumulator>=this.targetFrameTime;){this.tickFunction(),this.clearCanvas(),this.renderEntities(),this.checkWatchedVariables();for(let i in this.debugWatchedEntities){let o=this.debugWatchedEntities[i];if(o.isDestroyed==!0){this.debugWatchedEntities.pop(i);break}try{o.text.update(o.entity.x-o.text.getWidth(this.context)/2,o.entity.y-o.offsetY,(o.entity.id?o.entity.id:"unnamed_entity")+` x: ${Math.round(o.entity.x)}, y: ${Math.round(o.entity.y)}; ${o.entity instanceof X?`children: ${o.entity.entities.length}`:""}`,13,"monospace"),o.centerMarker.update(o.entity.x,o.entity.y)}catch(a){console.error(a)}}this.deltaAccumulator-=this.targetFrameTime}this.animationFrameId=requestAnimationFrame(i=>this.gameLoop(i))}}clearCanvas(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}destroyEntity(t){let e=this.entities.indexOf(t);e!==-1&&(this.entities.splice(e,1),t.destroy())}setCenterOrigin(){this.renderingOrigin="center"}resetOrigin(){this.renderingOrigin="topleft"}customZSort(){}setBackground(t={}){let{color:e=null,image:i=null,repeat:o=null}=t;if(this.backgroundColor=e,this.backgroundImage=i,this.backgroundRepeat=o,e)this.canvas.style.backgroundColor=e;else if(i){let a=`url(${i})`;o&&(a+=` ${o}`),a+=" / 100% 100%",this.canvas.style.background=a}else this.canvas.style.backgroundColor=null,this.canvas.style.background=null}};var U=class{constructor(t,e=120){this.engine=new S(t,e,{__fcm__:!0})}configure(t={}){let{preload:e=()=>{},setup:i=()=>{},tick:o=()=>{},centeredOrigin:a=!1,maxEntities:c=500,webGLMode:d=!1}=t;d&&(this.engine.webGLMode=!0,this.engine.context=this.engine.canvas.getContext("webgl")),this.engine.maxEntities=c,this.engine.configure({preload:e,setup:i,tick:o,centeredOrigin:a})}start(){this.engine.start()}stop(){console.log(this.engine),this.engine.tickFunction=()=>{console.warn("WSP FAM")},console.log(this.engine)}};var j=class{constructor(t,e){this.x=t,this.y=e}update(t,e){this.x=t,this.y=e}};var N=class{constructor(t){if(!(t instanceof S))throw new Error("Expected engineRef to be instanceof Engine.");this.engineRef=t,this.cameras={},this.currentCamera=null}addCamera(t,e){if(!(e instanceof j))throw new Error("addCamera expects type Camera");if(this.cameras[t])throw new Error("Camera with that name already exists");this.cameras[t]=e}setCamera(t){if(!this.cameras[t])throw new Error("Camera with that name does not exist");this.currentCamera=this.cameras[t],this.activateCamera()}updateCamera(t,e=0,i=0){if(!this.cameras[t])throw new Error("Camera with that name does not exist");return this.cameras[t].update(e,i),this.currentCamera=this.cameras[t],this.activateCamera(),this.cameras[t]}activateCamera(){try{this.engineRef.camx=this.currentCamera.x,this.engineRef.camy=this.currentCamera.y}catch(t){console.error(t)}}shakeEffect(t,e,i){for(let o=0;o<e*100;o++)setTimeout(()=>{let a=Math.random()*i-i/2,c=Math.random()*i-i/2;this.updateCamera(t,a,c)},o*10)}};var we=class{constructor(){this.scenes={},this.currentScene=null,this.currentEngine=null,this.cameraManager=null}addScene(t,e,i){if(!(e instanceof U))throw new Error("Add scene expects type Scene");if(this.scenes[t])throw new Error("Scene with that name already exists");this.scenes[t]=[e,i],this.scenes[t][0].configure(this.scenes[t][1]),this.currentEngine=this.scenes[t][0].engine}setScene(t){if(!this.scenes[t])throw new Error("Scene with that name does not exist");this.currentScene=this.scenes[t],this.currentEngine=this.currentScene[0].engine,this.cameraManager&&(this.cameraManager.engineRef=this.currentEngine,this.cameraManager.activateCamera()),this.startScene()}startScene(){this.currentScene&&(this.currentScene[0].configure(this.currentScene[1]),this.currentScene[0].start())}addCameraManager(t){if(!(t instanceof N))throw new Error("Expected instanceof CameraManager.");this.cameraManager=t}};var Ce=class{constructor(){this.states={}}addState(t,e){this.states[t]=e}getState(t){return this.states[t]?this.states[t]:null}removeState(t){this.states[t]=null}watchState(t,e,i){if(!(e instanceof S))throw new Error("Expected engineRef to be instance of Engine.");e.watch(i,[()=>this.states[t]])}};var $e=class{constructor(t=null){if(this.engineRef=t,!t instanceof S)throw new Error("Expected engine ref to be of type Engine.");this.entity=null,this.hitbox=null}setEntity(t){this.entity=t}setHitbox(t){this.hitbox=t,this.entity&&this.engineRef.watch(()=>{this.hitbox.x=this.entity.x,this.hitbox.y=this.entity.y},[()=>this.entity.x,()=>this.entity.y])}render(){this.entity&&this.engineRef.addEntity(this.entity),this.hitbox&&this.engineRef.addEntity(this.hitbox)}destroy(){this.entity&&this.engineRef.destroyEntity(this.entity),this.hitbox&&this.engineRef.destroyEntity(this.hitbox)}};var Re=class{constructor(t){this.entity=t,this.currentTexture=0,this.textures=[]}addTexture(t){this.textures.push(t)}applyTexture(t){this.currentTexture=t,this.entity.setTexture(this.textures[t])}removeTexture(){this.entity.setTexture(null)}nextTexture(){this.currentTexture<this.textures.length-1?this.currentTexture+=1:this.currentTexture=0,this.applyTexture(this.currentTexture)}prevTexture(){this.currentTexture>0?this.currentTexture-=1:this.currentTexture=0,this.applyTexture(this.currentTexture)}};var fi={};ie(fi,{compile:()=>wt,evalBytecode:()=>ci,generateAST:()=>hi});function cs(r,t){function e(){this.constructor=r}e.prototype=t.prototype,r.prototype=new e}function H(r,t,e,i){var o=Error.call(this,r);return Object.setPrototypeOf&&Object.setPrototypeOf(o,H.prototype),o.expected=t,o.found=e,o.location=i,o.name="SyntaxError",o}cs(H,Error);function Et(r,t,e){return e=e||" ",r.length>t?r:(t-=r.length,e+=e.repeat(t),r+e.slice(0,t))}H.prototype.format=function(r){var t="Error: "+this.message;if(this.location){var e=null,i;for(i=0;i<r.length;i++)if(r[i].source===this.location.source){e=r[i].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,a=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(o):o,c=this.location.source+":"+a.line+":"+a.column;if(e){var d=this.location.end,y=Et("",a.line.toString().length," "),g=e[o.line-1],x=o.line===d.line?d.column:g.length+1,$=x-o.column||1;t+=`
 --> `+c+`
`+y+` |
`+a.line+" | "+g+`
`+y+" | "+Et("",o.column-1," ")+Et("",$,"^")}else t+=`
 at `+c}return t};H.buildMessage=function(r,t){var e={literal:function(g){return'"'+o(g.text)+'"'},class:function(g){var x=g.parts.map(function($){return Array.isArray($)?a($[0])+"-"+a($[1]):a($)});return"["+(g.inverted?"^":"")+x.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(g){return g.description}};function i(g){return g.charCodeAt(0).toString(16).toUpperCase()}function o(g){return g.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(x){return"\\x0"+i(x)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(x){return"\\x"+i(x)})}function a(g){return g.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(x){return"\\x0"+i(x)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(x){return"\\x"+i(x)})}function c(g){return e[g.type](g)}function d(g){var x=g.map(c),$,k;if(x.sort(),x.length>0){for($=1,k=1;$<x.length;$++)x[$-1]!==x[$]&&(x[k]=x[$],k++);x.length=k}switch(x.length){case 1:return x[0];case 2:return x[0]+" or "+x[1];default:return x.slice(0,-1).join(", ")+", or "+x[x.length-1]}}function y(g){return g?'"'+o(g)+'"':"end of input"}return"Expected "+d(r)+" but "+y(t)+" found."};function hi(r,t){t=t!==void 0?t:{};var e={},i=t.grammarSource,o={start:Nt},a=Nt,c=";",d="var",y="=",g="js!",x="if",$="then",k="end",P="print",F="(",O=")",V="function",G=",",se="True",re="False",ne="==",oe='"',J='\\\\"',Pe=/^[A-Z_$a-z]/,ae=/^[A-Z_a-z0-9]/,Lt=/^[^"]/,Mt=/^[+\-]/,At=/^[*\/]/,Ft=/^[0-9]/,Bt=/^[ \t\n\r]/,W=L(";",!1),Dt=L("var",!1),Wt=L("=",!1),mi=L("js!",!1),Ot=L("if",!1),Vt=L("then",!1),Ie=L("end",!1),Yt=L("print",!1),le=L("(",!1),he=L(")",!1),zt=L("function",!1),ce=L(",",!1),yi=L("True",!1),xi=L("False",!1),vi=_([["A","Z"],"_","$",["a","z"]],!1,!1),Xt=_([["A","Z"],"_",["a","z"],["0","9"]],!1,!1),bi=L("==",!1),_t=L('"',!1),Ht=_(['"'],!0,!1),Gt=L('\\\\"',!1),Jt=_(["+","-"],!1,!1),Kt=_(["*","/"],!1,!1),Ei=Le("integer"),qt=_([["0","9"]],!1,!1),wi=Le("whitespace"),Zt=_([" ","	",`
`,"\r"],!1,!1),Ci=function(s){return{type:"Program",body:s}},$i=function(s,l){return[s].concat(l.map(function(f){return f[2]}))},Ri=function(s){return{type:"ExpressionStatement",expression:s}},ki=function(s,l){return{type:"AssignmentStatement",Identifier:s,Value:l}},Si=function(s,l){return{type:"ReassignmentStatement",Identifier:s,Value:l}},Pi=function(s){return{type:"JavaScriptStatement",code:s}},Ii=function(s,l){return{type:"IfStatement",test:s,consequent:{type:"BlockStatement",body:l},alternate:null}},Ti=function(s){return{type:"PrintStatement",value:s}},Li=function(s,l,f){return{type:"FunctionDeclaration",name:s,parameters:l,body:f}},Mi=function(s,l){return{type:"FunctionCall",name:s,arguments:l}},Ai=function(s,l){return[s].concat(l.map(function(f){return f[2]}))},Fi=function(s,l){return[s].concat(l.map(function(f){return f[2]}))},Bi=function(s){return s},Di=function(s){return{type:"Literal",value:s}},Wi=function(){return!0},Oi=function(){return!1},Vi=function(s){return{type:"Identifier",name:s}},Yi=function(s){return{type:"Identifier",name:s}},zi=function(){return Te()},Xi=function(s,l){return{type:"BinaryExpression",operator:"==",left:s,right:l}},_i=function(){return JSON.parse(Te())},Hi=function(s,l){return l.reduce(function(f,h){return{type:"BinaryExpression",operator:h[1],left:f,right:h[3]}},s)},Gi=function(s,l){return l.reduce(function(f,h){return{type:"BinaryExpression",operator:h[1],left:f,right:h[3]}},s)},Ji=function(s){return s},Ki=function(){return parseInt(Te(),10)},qi=function(){return[]},n=t.peg$currPos|0,R=n,K=[{line:1,column:1}],A=n,fe=t.peg$maxFailExpected||[],p=t.peg$silentFails|0,Q;if(t.startRule){if(!(t.startRule in o))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');a=o[t.startRule]}function Te(){return r.substring(R,n)}function gs(){return R}function ms(){return{source:i,start:R,end:n}}function ys(){return ee(R,n)}function xs(s,l){throw l=l!==void 0?l:ee(R,n),jt([Le(s)],r.substring(R,n),l)}function vs(s,l){throw l=l!==void 0?l:ee(R,n),Ui(s,l)}function L(s,l){return{type:"literal",text:s,ignoreCase:l}}function _(s,l,f){return{type:"class",parts:s,inverted:l,ignoreCase:f}}function bs(){return{type:"any"}}function Zi(){return{type:"end"}}function Le(s){return{type:"other",description:s}}function Ut(s){var l=K[s],f;if(l)return l;if(s>=K.length)f=K.length-1;else for(f=s;!K[--f];);for(l=K[f],l={line:l.line,column:l.column};f<s;)r.charCodeAt(f)===10?(l.line++,l.column=1):l.column++,f++;return K[s]=l,l}function ee(s,l,f){var h=Ut(s),m=Ut(l),u={source:i,start:{offset:s,line:h.line,column:h.column},end:{offset:l,line:m.line,column:m.column}};return f&&i&&typeof i.offset=="function"&&(u.start=i.offset(u.start),u.end=i.offset(u.end)),u}function v(s){n<A||(n>A&&(A=n,fe=[]),fe.push(s))}function Ui(s,l){return new H(s,null,null,l)}function jt(s,l,f){return new H(H.buildMessage(s,l),s,l,f)}function Nt(){var s,l,f,h;return s=n,l=E(),f=Me(),f===e&&(f=E()),f!==e?(h=E(),R=s,s=Ci(f)):(n=s,s=e),s}function Me(){var s,l,f,h,m,u,b,w,C;if(s=n,l=E(),f=De(),f===e&&(f=Be(),f===e&&(f=Fe(),f===e&&(f=We(),f===e&&(f=Oe(),f===e&&(f=Ae(),f===e&&(f=Ve(),f===e&&(f=Ye()))))))),f!==e){for(h=E(),m=[],u=n,b=n,p++,r.charCodeAt(n)===59?(w=c,n++):(w=e,p===0&&v(W)),p--,w===e?b=void 0:(n=b,b=e),b!==e?(w=E(),C=De(),C===e&&(C=Be(),C===e&&(C=Fe(),C===e&&(C=We(),C===e&&(C=Oe(),C===e&&(C=Ae(),C===e&&(C=Ve(),C===e&&(C=Ye()))))))),C!==e?(b=[b,w,C],u=b):(n=u,u=e)):(n=u,u=e);u!==e;)m.push(u),u=n,b=n,p++,r.charCodeAt(n)===59?(w=c,n++):(w=e,p===0&&v(W)),p--,w===e?b=void 0:(n=b,b=e),b!==e?(w=E(),C=De(),C===e&&(C=Be(),C===e&&(C=Fe(),C===e&&(C=We(),C===e&&(C=Oe(),C===e&&(C=Ae(),C===e&&(C=Ve(),C===e&&(C=Ye()))))))),C!==e?(b=[b,w,C],u=b):(n=u,u=e)):(n=u,u=e);R=s,s=$i(f,m)}else n=s,s=e;return s}function Ae(){var s,l,f,h;return s=n,l=B(),l!==e?(f=E(),r.charCodeAt(n)===59?(h=c,n++):(h=e,p===0&&v(W)),h!==e?(R=s,s=Ri(l)):(n=s,s=e)):(n=s,s=e),s}function Fe(){var s,l,f,h,m,u,b,w,C,M;return s=n,r.substr(n,3)===d?(l=d,n+=3):(l=e,p===0&&v(Dt)),l!==e?(f=E(),h=de(),h!==e?(m=E(),r.charCodeAt(n)===61?(u=y,n++):(u=e,p===0&&v(Wt)),u!==e?(b=E(),w=B(),w!==e?(C=E(),r.charCodeAt(n)===59?(M=c,n++):(M=e,p===0&&v(W)),M!==e?(R=s,s=ki(h,w)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e),s}function Be(){var s,l,f,h,m,u,b,w;return s=n,l=de(),l!==e?(f=E(),r.charCodeAt(n)===61?(h=y,n++):(h=e,p===0&&v(Wt)),h!==e?(m=E(),u=B(),u!==e?(b=E(),r.charCodeAt(n)===59?(w=c,n++):(w=e,p===0&&v(W)),w!==e?(R=s,s=Si(l,u)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e),s}function De(){var s,l,f,h,m,u;return s=n,r.substr(n,3)===g?(l=g,n+=3):(l=e,p===0&&v(mi)),l!==e?(f=E(),h=ii(),h!==e?(m=E(),r.charCodeAt(n)===59?(u=c,n++):(u=e,p===0&&v(W)),u!==e?(R=s,s=Pi(h)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e),s}function We(){var s,l,f,h,m,u,b,w,C;return s=n,r.substr(n,2)===x?(l=x,n+=2):(l=e,p===0&&v(Ot)),l!==e?(f=E(),h=es(),h===e&&(h=B()),h!==e?(m=E(),r.substr(n,4)===$?(u=$,n+=4):(u=e,p===0&&v(Vt)),u!==e?(b=Me(),b===e&&(b=E()),b!==e?(w=E(),r.substr(n,3)===k?(C=k,n+=3):(C=e,p===0&&v(Ie)),C!==e?(R=s,s=Ii(h,b)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e),s}function Oe(){var s,l,f,h,m,u,b,w,C,M;return s=n,r.substr(n,5)===P?(l=P,n+=5):(l=e,p===0&&v(Yt)),l!==e?(f=E(),r.charCodeAt(n)===40?(h=F,n++):(h=e,p===0&&v(le)),h!==e?(m=E(),u=B(),u===e&&(u=""),u!==e?(b=E(),r.charCodeAt(n)===41?(w=O,n++):(w=e,p===0&&v(he)),w!==e?(C=E(),r.charCodeAt(n)===59?(M=c,n++):(M=e,p===0&&v(W)),M!==e?(R=s,s=Ti(u)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e),s}function Ve(){var s,l,f,h,m,u,b,w,C,M,is,_e,ss,He,rs,Ge;return s=n,r.substr(n,8)===V?(l=V,n+=8):(l=e,p===0&&v(zt)),l!==e?(f=E(),h=te(),h!==e?(m=E(),r.charCodeAt(n)===40?(u=F,n++):(u=e,p===0&&v(le)),u!==e?(b=E(),w=ji(),w!==e?(C=E(),r.charCodeAt(n)===41?(M=O,n++):(M=e,p===0&&v(he)),M!==e?(is=E(),_e=Me(),_e!==e?(ss=E(),r.substr(n,3)===k?(He=k,n+=3):(He=e,p===0&&v(Ie)),He!==e?(rs=E(),r.charCodeAt(n)===59?(Ge=c,n++):(Ge=e,p===0&&v(W)),Ge!==e?(R=s,s=Li(h,w,_e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e),s}function Ye(){var s,l,f,h,m,u,b,w,C,M;return s=n,l=te(),l!==e?(f=E(),r.charCodeAt(n)===40?(h=F,n++):(h=e,p===0&&v(le)),h!==e?(m=E(),u=Ni(),u!==e?(b=E(),r.charCodeAt(n)===41?(w=O,n++):(w=e,p===0&&v(he)),w!==e?(C=E(),r.charCodeAt(n)===59?(M=c,n++):(M=e,p===0&&v(W)),M!==e?(R=s,s=Mi(l,u)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e),s}function ji(){var s,l,f,h,m,u,b;if(s=n,l=te(),l===e&&(l=""),l!==e){for(f=[],h=n,m=n,p++,r.charCodeAt(n)===44?(u=G,n++):(u=e,p===0&&v(ce)),p--,u===e?m=void 0:(n=m,m=e),m!==e?(u=E(),b=te(),b!==e?(m=[m,u,b],h=m):(n=h,h=e)):(n=h,h=e);h!==e;)f.push(h),h=n,m=n,p++,r.charCodeAt(n)===44?(u=G,n++):(u=e,p===0&&v(ce)),p--,u===e?m=void 0:(n=m,m=e),m!==e?(u=E(),b=te(),b!==e?(m=[m,u,b],h=m):(n=h,h=e)):(n=h,h=e);R=s,s=Ai(l,f)}else n=s,s=e;return s}function Ni(){var s,l,f,h,m,u,b;if(s=n,l=B(),l===e&&(l=""),l!==e){for(f=[],h=n,m=n,p++,r.charCodeAt(n)===44?(u=G,n++):(u=e,p===0&&v(ce)),p--,u===e?m=void 0:(n=m,m=e),m!==e?(u=E(),b=B(),b!==e?(m=[m,u,b],h=m):(n=h,h=e)):(n=h,h=e);h!==e;)f.push(h),h=n,m=n,p++,r.charCodeAt(n)===44?(u=G,n++):(u=e,p===0&&v(ce)),p--,u===e?m=void 0:(n=m,m=e),m!==e?(u=E(),b=B(),b!==e?(m=[m,u,b],h=m):(n=h,h=e)):(n=h,h=e);R=s,s=Fi(l,f)}else n=s,s=e;return s}function B(){var s,l;return s=n,l=Qi(),l===e&&(l=Qt(),l===e&&(l=ei(),l===e&&(l=si()))),l!==e&&(R=s,l=Bi(l)),s=l,s}function Qt(){var s,l;return s=n,l=ii(),l===e&&(l=ts(),l===e&&(l=ei())),l!==e&&(R=s,l=Di(l)),s=l,s}function ei(){var s,l;return s=n,r.substr(n,4)===se?(l=se,n+=4):(l=e,p===0&&v(yi)),l!==e&&(R=s,l=Wi()),s=l,s===e&&(s=n,r.substr(n,5)===re?(l=re,n+=5):(l=e,p===0&&v(xi)),l!==e&&(R=s,l=Oi()),s=l),s}function Qi(){var s,l,f;return s=n,l=n,p++,f=ti(),p--,f===e?l=void 0:(n=l,l=e),l!==e?(f=de(),f!==e?(R=s,s=Vi(f)):(n=s,s=e)):(n=s,s=e),s}function te(){var s,l,f;return s=n,l=n,p++,f=ti(),p--,f===e?l=void 0:(n=l,l=e),l!==e?(f=de(),f!==e?(R=s,s=Yi(f)):(n=s,s=e)):(n=s,s=e),s}function ti(){var s;return r.substr(n,3)===d?(s=d,n+=3):(s=e,p===0&&v(Dt)),s===e&&(r.substr(n,2)===x?(s=x,n+=2):(s=e,p===0&&v(Ot)),s===e&&(r.substr(n,4)===$?(s=$,n+=4):(s=e,p===0&&v(Vt)),s===e&&(r.substr(n,3)===k?(s=k,n+=3):(s=e,p===0&&v(Ie)),s===e&&(r.substr(n,5)===P?(s=P,n+=5):(s=e,p===0&&v(Yt)),s===e&&(r.substr(n,8)===V?(s=V,n+=8):(s=e,p===0&&v(zt))))))),s}function de(){var s,l,f,h;if(s=n,l=r.charAt(n),Pe.test(l)?n++:(l=e,p===0&&v(vi)),l!==e){for(f=[],h=r.charAt(n),ae.test(h)?n++:(h=e,p===0&&v(Xt));h!==e;)f.push(h),h=r.charAt(n),ae.test(h)?n++:(h=e,p===0&&v(Xt));R=s,s=zi()}else n=s,s=e;return s}function es(){var s,l,f,h,m,u,b,w;return s=n,l=E(),f=B(),f!==e?(h=E(),r.substr(n,2)===ne?(m=ne,n+=2):(m=e,p===0&&v(bi)),m!==e?(u=E(),b=B(),b!==e?(w=E(),R=s,s=Xi(f,b)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e),s}function ii(){var s,l,f,h;if(s=n,r.charCodeAt(n)===34?(l=oe,n++):(l=e,p===0&&v(_t)),l!==e){for(f=[],h=r.charAt(n),Lt.test(h)?n++:(h=e,p===0&&v(Ht)),h===e&&(r.substr(n,3)===J?(h=J,n+=3):(h=e,p===0&&v(Gt)));h!==e;)f.push(h),h=r.charAt(n),Lt.test(h)?n++:(h=e,p===0&&v(Ht)),h===e&&(r.substr(n,3)===J?(h=J,n+=3):(h=e,p===0&&v(Gt)));r.charCodeAt(n)===34?(h=oe,n++):(h=e,p===0&&v(_t)),h!==e?(R=s,s=_i()):(n=s,s=e)}else n=s,s=e;return s}function si(){var s,l,f,h,m,u,b,w;if(s=n,l=ze(),l!==e){for(f=[],h=n,m=E(),u=r.charAt(n),Mt.test(u)?n++:(u=e,p===0&&v(Jt)),u!==e?(b=E(),w=ze(),w!==e?(m=[m,u,b,w],h=m):(n=h,h=e)):(n=h,h=e);h!==e;)f.push(h),h=n,m=E(),u=r.charAt(n),Mt.test(u)?n++:(u=e,p===0&&v(Jt)),u!==e?(b=E(),w=ze(),w!==e?(m=[m,u,b,w],h=m):(n=h,h=e)):(n=h,h=e);R=s,s=Hi(l,f)}else n=s,s=e;return s}function ze(){var s,l,f,h,m,u,b,w;if(s=n,l=Xe(),l!==e){for(f=[],h=n,m=E(),u=r.charAt(n),At.test(u)?n++:(u=e,p===0&&v(Kt)),u!==e?(b=E(),w=Xe(),w!==e?(m=[m,u,b,w],h=m):(n=h,h=e)):(n=h,h=e);h!==e;)f.push(h),h=n,m=E(),u=r.charAt(n),At.test(u)?n++:(u=e,p===0&&v(Kt)),u!==e?(b=E(),w=Xe(),w!==e?(m=[m,u,b,w],h=m):(n=h,h=e)):(n=h,h=e);R=s,s=Gi(l,f)}else n=s,s=e;return s}function Xe(){var s,l,f,h,m,u;return s=n,r.charCodeAt(n)===40?(l=F,n++):(l=e,p===0&&v(le)),l!==e?(f=E(),h=si(),h!==e?(m=E(),r.charCodeAt(n)===41?(u=O,n++):(u=e,p===0&&v(he)),u!==e?(R=s,s=Ji(h)):(n=s,s=e)):(n=s,s=e)):(n=s,s=e),s===e&&(s=Qt()),s}function ts(){var s,l,f,h;if(p++,s=n,l=E(),f=[],h=r.charAt(n),Ft.test(h)?n++:(h=e,p===0&&v(qt)),h!==e)for(;h!==e;)f.push(h),h=r.charAt(n),Ft.test(h)?n++:(h=e,p===0&&v(qt));else f=e;return f!==e?(R=s,s=Ki()):(n=s,s=e),p--,s===e&&(l=e,p===0&&v(Ei)),s}function E(){var s,l,f;for(p++,s=n,l=[],f=r.charAt(n),Bt.test(f)?n++:(f=e,p===0&&v(Zt));f!==e;)l.push(f),f=r.charAt(n),Bt.test(f)?n++:(f=e,p===0&&v(Zt));return R=s,l=qi(),s=l,p--,l=e,p===0&&v(wi),s}if(Q=a(),t.peg$library)return{peg$result:Q,peg$currPos:n,peg$FAILED:e,peg$maxFailExpected:fe,peg$maxFailPos:A};if(Q!==e&&n===r.length)return Q;throw Q!==e&&n<r.length&&v(Zi()),jt(fe,A<r.length?r.charAt(A):null,A<r.length?ee(A,A+1):ee(A,A))}function wt(r){let t="";for(let e=0;e<r.body.length;e++){let i=r.body[e];if(i.type=="PrintStatement")i.value.type=="Identifier"?t+=`console.log(${i.value.name});`:t+=`console.log("${i.value.value}");`;else if(i.type=="AssignmentStatement")i.Value.type=="Identifier"?t+=`var ${i.Identifier} = ${i.Value.value?i.Value.value:i.Value.name};`:t+=`var ${i.Identifier} = ${JSON.stringify(i.Value.value?i.Value.value:i.Value.name)};`;else if(i.type=="ReassignmentStatement")i.Value.type=="Identifier"?t+=`${i.Identifier} = ${i.Value.value?i.Value.value:i.Value.name};`:t+=`${i.Identifier} = ${JSON.stringify(i.Value.value?i.Value.value:i.Value.name)};`;else if(i.type=="FunctionDeclaration"){t+=`function ${i.name.name}() {`;let o=wt({type:"Program",body:i.body});t+=o,t+="}"}else i.type=="JavaScriptStatement"?t+=`${i.code} 
`:i.type=="FunctionCall"&&(t+=`${i.name.name}();`)}return t}function ci(code){eval(code)}function di(r,t){if(!r||!r.x||!r.y)throw console.log(r),new Error("Invalid object passed into setX");try{r.update(t,r.y)}catch{try{r.x=t}catch(i){console.log("Error",i)}}}function ui(r,t){if(!r||!r.x||!r.y)throw console.log(r),new Error("Invalid object passed into setY");try{r.update(r.x,t)}catch{try{r.y=t}catch(i){console.log("Error",i)}}}function pi(r,t){if(!r||!r.fillColor)throw console.log(r),new Error("Invalid object passed into setFillColor");try{r.fillColor=t}catch(e){console.log("Error",e)}}function Ct(r,t,e,i,o,a){if(!(r instanceof S))throw new Error("Invalid engine ref passed to rect constructor");let c=new z(t,e,i,o,a);return r.addEntity(c),c}function $t(){}function Rt(r,t,e,i,o){if(!(r instanceof S))throw new Error("Invalid engine ref passed to rect constructor");let a=new Y(t,e,i,o);return r.addEntity(a),a}function kt(r){if(!(r instanceof S))throw new Error("Invalid engine ref passed to clear");for(let t of r.entities)r.destroyEntity(t)}function St(r,t=60){return new S(r,t)}var gi={};ie(gi,{getLogs:()=>ds,resetLogger:()=>ps});var ke=console.log,Tt=console.error,fs=console.onerror,It=class{constructor(){this.logs=[]}},Se=new It;function ds(){return Se.logs}var us=!1;function ps(){console.log=ke,console.error=Tt,console.onerror=fs}var Pt=!1;console.log=function(...r){if(r.some(e=>e&&e.optOut===!0)){ke.apply(console,r);return}Pt?ke.apply(console,r):(Pt=!0,Se.logs.push({type:"log",message:r}),ke.apply(console,r),Pt=!1)};console.error=function(...r){Se.logs.push({type:"thrown_error",message:r}),Tt.apply(console,r)};window.onerror=function(r,t,e,i,o){us||(Se.logs.push({type:"window_error",message:{message:r,source:t,lineno:e,colno:i,error:o}}),Tt("Uncaught error:",r,"at",t,"line",e,"column",i,"error object:",o))};export{j as Camera,N as CameraManager,Y as Ellipse,S as Engine,I as Entity,$e as EntityManager,X as Group,ft as PolyBased,q as Polygon,z as Rect,U as Scene,we as SceneManager,pe as Sound,Ce as StateManager,D as Text,Re as TextureManager,ct as Widgets,kt as clear,fi as compiler,St as createEngine,Rt as ellipse,gi as logger,$t as poly,Ct as rect,pi as setFillColor,di as setX,ui as setY};
